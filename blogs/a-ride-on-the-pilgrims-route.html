---
layout:      page
title:       A Ride on The Pilgrims' Route
--- 

<section id='blog-pannel'>
  <h1>{{ page.title }}</h1>
  <ul>
  {% for category in site.categories %}
    {% if page.title == category[0] %}
      {% for post in category[1] %}
      <li>
        <a href="{{ post.url }}"></a>
        <img src='{{ post.thumbnail }}'/>
        <p class='blog-index-post-date'>{{ post.date | date: "%Y %b %-d" }}</p>
        <div>
          {% assign day = post.url | slice: 13, 3 %}
          <p class='blog-index-post-title'>{% if day !=  'pil' %} Day #{{ day }} {% endif %}{{ post.title }}</p>
          <p>{{ post.content | replace: '<p>.*</p>', ''}}</p>
        </div>
      </li>
      {% endfor %}
    {% endif %}
  {% endfor %}
  </ul>
</section>
<section id='map-pannel'></section>

<script>
    
  // SETTING ---------------------------------------------------------------

  var map = L.map('map-pannel', {
    minZoom: 4,
    center: [55, 5],
    zoom: 4,
    zoomControl: false,
  })

  L.tileLayer(
    'http://server.arcgisonline.com/'+
    'ArcGIS/rest/services/World_Topo_Map/'+
    'MapServer/tile/{z}/{y}/{x}'
  ).addTo(map);

  $.getJSON("/data/2016-05-21-ev3.geojson", function(data) {

    var the_pilgrims_route = new L.geoJson(data, {
      opacity: 0.6,
      weight:  3.5
    });
    the_pilgrims_route = the_pilgrims_route.getLayers()[0];
    
    var itinerary = jQuery.extend(true, {}, the_pilgrims_route );
    itinerary.addTo(map);
  });

  var blogPannel;

  $("#blog-pannel a").click(function(e){

    // http://stackoverflow.com/questions/4002580/how-to-do-partial-page-update-with-jquery

    // prevent from going to the page and save content
    e.preventDefault();
    blogPannel = $("#blog-pannel").clone(true);

    // get the href
    var href       = $(this).attr("href") + ' #post > section > *';
    $("#blog-pannel").load(href, function(){

      // implement a close button
      $(this).prepend('<div id="close-button">Ã—</div>');
      $('#close-button').click(function(){
        $("#blog-pannel").remove();
        $("#a-ride-on-the-pilgrims-route").prepend(blogPannel);
      });

    });

  });

</script>